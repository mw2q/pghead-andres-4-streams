BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burnished%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267724596.916631
 ALGERIA                   |   1997 | 449862413.626754
 ALGERIA                   |   1996 | 457251423.382329
 ALGERIA                   |   1995 | 454099161.622995
 ALGERIA                   |   1994 | 456704927.894957
 ALGERIA                   |   1993 | 450871481.375455
 ALGERIA                   |   1992 | 451220011.027199
 ARGENTINA                 |   1998 | 273165938.252795
 ARGENTINA                 |   1997 | 470602554.451043
 ARGENTINA                 |   1996 | 469488536.220703
 ARGENTINA                 |   1995 | 470005456.970562
 ARGENTINA                 |   1994 | 470062396.922494
 ARGENTINA                 |   1993 |   469418988.4894
 ARGENTINA                 |   1992 | 464491758.369337
 BRAZIL                    |   1998 | 277158681.021303
 BRAZIL                    |   1997 | 459564396.646871
 BRAZIL                    |   1996 | 463899698.293105
 BRAZIL                    |   1995 |  461081206.25374
 BRAZIL                    |   1994 | 462517910.120625
 BRAZIL                    |   1993 | 461619514.660988
 BRAZIL                    |   1992 | 462836308.120076
 CANADA                    |   1998 | 280847120.855018
 CANADA                    |   1997 | 472296632.362579
 CANADA                    |   1996 | 478438465.620283
 CANADA                    |   1995 | 476016574.980649
 CANADA                    |   1994 | 479900526.887882
 CANADA                    |   1993 | 483258181.823509
 CANADA                    |   1992 | 480684680.150777
 CHINA                     |   1998 |  270044315.79036
 CHINA                     |   1997 | 463559897.821804
 CHINA                     |   1996 | 462939334.784297
 CHINA                     |   1995 | 455791718.589747
 CHINA                     |   1994 | 461727129.727437
 CHINA                     |   1993 | 460786341.176655
 CHINA                     |   1992 | 464789487.866104
 EGYPT                     |   1998 | 269644364.434574
 EGYPT                     |   1997 | 458457783.782205
 EGYPT                     |   1996 | 464143139.539961
 EGYPT                     |   1995 | 463212276.278386
 EGYPT                     |   1994 |  461374897.75952
 EGYPT                     |   1993 | 468813336.827845
 EGYPT                     |   1992 | 461257471.646539
 ETHIOPIA                  |   1998 |  272310719.92959
 ETHIOPIA                  |   1997 | 450603416.339446
 ETHIOPIA                  |   1996 | 457126285.363475
 ETHIOPIA                  |   1995 |  463487001.06619
 ETHIOPIA                  |   1994 | 457313384.445645
 ETHIOPIA                  |   1993 |  455869140.21118
 ETHIOPIA                  |   1992 |  457769747.16516
 FRANCE                    |   1998 | 273074486.951602
 FRANCE                    |   1997 | 457892574.788699
 FRANCE                    |   1996 | 455240713.265485
 FRANCE                    |   1995 | 458513965.188266
 FRANCE                    |   1994 | 449153384.673618
 FRANCE                    |   1993 | 457773452.046835
 FRANCE                    |   1992 | 458268957.322296
 GERMANY                   |   1998 | 277061756.441689
 GERMANY                   |   1997 | 478086657.312883
 GERMANY                   |   1996 | 472308238.457045
 GERMANY                   |   1995 | 484179151.379566
 GERMANY                   |   1994 | 472254153.388568
 GERMANY                   |   1993 | 474984939.008741
 GERMANY                   |   1992 | 488351375.084147
 INDIA                     |   1998 | 276205271.980449
 INDIA                     |   1997 | 471856464.877877
 INDIA                     |   1996 | 472834832.618862
 INDIA                     |   1995 | 465640881.896888
 INDIA                     |   1994 | 475161314.786815
 INDIA                     |   1993 | 471148373.917151
 INDIA                     |   1992 | 471127599.696878
 INDONESIA                 |   1998 | 272880585.889981
 INDONESIA                 |   1997 |  460465869.30949
 INDONESIA                 |   1996 | 470574012.227413
 INDONESIA                 |   1995 | 460879796.540128
 INDONESIA                 |   1994 | 465174465.731606
 INDONESIA                 |   1993 | 464251335.663323
 INDONESIA                 |   1992 | 459335475.677351
 IRAN                      |   1998 | 273806413.582781
 IRAN                      |   1997 | 461110296.105133
 IRAN                      |   1996 | 466139846.976492
 IRAN                      |   1995 | 469153060.661268
 IRAN                      |   1994 | 461942588.301587
 IRAN                      |   1993 | 463385187.477957
 IRAN                      |   1992 | 460768557.836089
 IRAQ                      |   1998 | 277531649.819327
 IRAQ                      |   1997 |  471631326.58414
 IRAQ                      |   1996 |  478756035.11173
 IRAQ                      |   1995 |  476470844.07054
 IRAQ                      |   1994 | 477617218.537438
 IRAQ                      |   1993 | 473372078.397494
 IRAQ                      |   1992 | 474120981.794659
 JAPAN                     |   1998 | 267276776.643239
 JAPAN                     |   1997 | 462621579.153066
 JAPAN                     |   1996 |  467550340.81278
 JAPAN                     |   1995 | 459238310.570315
 JAPAN                     |   1994 | 472531733.193842
 JAPAN                     |   1993 | 467956715.931162
 JAPAN                     |   1992 | 468442311.591536
 JORDAN                    |   1998 | 272601098.518073
 JORDAN                    |   1997 | 462960651.031831
 JORDAN                    |   1996 | 463443895.113329
 JORDAN                    |   1995 | 459166620.025317
 JORDAN                    |   1994 | 459048357.680684
 JORDAN                    |   1993 | 463278764.691664
 JORDAN                    |   1992 | 461843976.666403
 KENYA                     |   1998 | 272859007.888241
 KENYA                     |   1997 | 464665469.888466
 KENYA                     |   1996 | 463684767.506661
 KENYA                     |   1995 | 461053894.119926
 KENYA                     |   1994 | 466950492.964584
 KENYA                     |   1993 | 464539850.072952
 KENYA                     |   1992 | 472126667.694499
 MOROCCO                   |   1998 | 275127096.334255
 MOROCCO                   |   1997 | 468760675.958467
 MOROCCO                   |   1996 | 463223510.415299
 MOROCCO                   |   1995 | 464255134.312553
 MOROCCO                   |   1994 | 468443186.046424
 MOROCCO                   |   1993 | 471692341.818936
 MOROCCO                   |   1992 | 467797700.349451
 MOZAMBIQUE                |   1998 |  274339068.25859
 MOZAMBIQUE                |   1997 | 475334334.545717
 MOZAMBIQUE                |   1996 | 472878935.667479
 MOZAMBIQUE                |   1995 | 468654697.477529
 MOZAMBIQUE                |   1994 |  472554425.45267
 MOZAMBIQUE                |   1993 | 465459632.573853
 MOZAMBIQUE                |   1992 | 469910800.802572
 PERU                      |   1998 | 271668028.218192
 PERU                      |   1997 |  476329730.00869
 PERU                      |   1996 | 479000193.160057
 PERU                      |   1995 | 470685929.966221
 PERU                      |   1994 | 468318361.258773
 PERU                      |   1993 | 468613169.663534
 PERU                      |   1992 | 474893888.013533
 ROMANIA                   |   1998 | 272568322.542648
 ROMANIA                   |   1997 | 461719061.645199
 ROMANIA                   |   1996 | 477729974.711878
 ROMANIA                   |   1995 | 464245721.076841
 ROMANIA                   |   1994 | 473976134.152452
 ROMANIA                   |   1993 | 471867229.517033
 ROMANIA                   |   1992 | 473136551.684679
 RUSSIA                    |   1998 | 282773754.447845
 RUSSIA                    |   1997 | 483494781.673345
 RUSSIA                    |   1996 | 479762144.786751
 RUSSIA                    |   1995 | 473039629.416925
 RUSSIA                    |   1994 | 480774356.394618
 RUSSIA                    |   1993 | 470284586.886315
 RUSSIA                    |   1992 | 478299482.199905
 SAUDI ARABIA              |   1998 | 276627156.997896
 SAUDI ARABIA              |   1997 | 469642832.582198
 SAUDI ARABIA              |   1996 | 477154194.658835
 SAUDI ARABIA              |   1995 | 467717428.801646
 SAUDI ARABIA              |   1994 | 472269995.929898
 SAUDI ARABIA              |   1993 | 468719946.675326
 SAUDI ARABIA              |   1992 | 474258458.567473
 UNITED KINGDOM            |   1998 |  271264076.38207
 UNITED KINGDOM            |   1997 | 470912785.132631
 UNITED KINGDOM            |   1996 | 465524768.111316
 UNITED KINGDOM            |   1995 | 462688138.876925
 UNITED KINGDOM            |   1994 |  460451688.47572
 UNITED KINGDOM            |   1993 | 460454334.594531
 UNITED KINGDOM            |   1992 | 460095695.774171
 UNITED STATES             |   1998 | 271867996.285561
 UNITED STATES             |   1997 |  461574924.71708
 UNITED STATES             |   1996 | 476439381.058568
 UNITED STATES             |   1995 | 469376320.994107
 UNITED STATES             |   1994 | 472074934.947569
 UNITED STATES             |   1993 | 464799852.262354
 UNITED STATES             |   1992 | 471338122.527574
 VIETNAM                   |   1998 |  276970306.40224
 VIETNAM                   |   1997 | 472171168.729786
 VIETNAM                   |   1996 | 478841006.912316
 VIETNAM                   |   1995 | 471214548.163719
 VIETNAM                   |   1994 | 472248201.896477
 VIETNAM                   |   1993 | 478531662.384655
 VIETNAM                   |   1992 |  476119984.62303
(175 rows)

COMMIT;
COMMIT
